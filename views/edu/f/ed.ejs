<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>edu</title>
    <link rel="stylesheet" href="/css/wakastyles.css">
</head>
<body>
  <header>
    <div class="banner">
      <button class="btn btn-link" onclick="window.location.href='/'">ãƒ›ãƒ¼ãƒ <br>ğŸ </button>
      <button class="btn btn-link" onclick="window.open('/edu/site', '_blank')">ã‚µã‚¤ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</button>
    </div>
  </header>
  <form id="IdForm">
    <input type="text" id="Idtext" placeholder="ç·¨é›†ã—ãŸã„ãƒšãƒ¼ã‚¸ã®Idã‚’å…¥åŠ›..." required>
    <button type="submit" name="action">ç·¨é›†ã™ã‚‹</button>
    <p id="errorMessage" style="color: red;"></p>
</form>
<section class="terms">
  <h2>ç·¨é›†ã™ã‚‹ã¨ãã®æ³¨æ„</h2>
  <ul>
    <li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯æ­£ã—ãå…¥åŠ›ã—ã¦ä¸‹ã•ã„ã€‚ç·¨é›†ãŒä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚</li>
    <li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½•åº¦ã‚‚é–“é•ãˆã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã¯ã‚ãªãŸã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è‡ªå‹•çš„ã«æ‹’å¦ã—ã¾ã™ã€‚æ°—ã‚’ã¤ã‘ã¦ãã ã•ã„</li>
  </ul>
</section>
<script>
document.getElementById('IdForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    
    const Id = document.getElementById('Idtext').value;
    const idPattern = /^[a-zA-Z0-9-_]+$/;
    const errorMessageElement = document.getElementById('errorMessage');

    errorMessageElement.textContent = '';

    if (!idPattern.test(Id)) {
        errorMessageElement.textContent = 'ã“ã®IDã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚';
        return;
    }
    
    try {
        const response = await fetch(`/edu/request?path=/req/${Id}`);
        if (!response.ok) {
            errorMessageElement.textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
            return;
        }
        const { p } = await response.json();
        
        if (p == "no") {
            errorMessageElement.textContent = 'ã“ã®IDã®ãƒšãƒ¼ã‚¸ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚';
            return;
        }
        window.location.href = `/edu/edit/${Id}`;
    } catch (err) {
        console.error('ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', err);
        errorMessageElement.textContent = 'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚';
    }
});

    </script>
</body>
</html>