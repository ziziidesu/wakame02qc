<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>edu</title>
    <link rel="stylesheet" href="/css/wakastyles.css">
</head>
<body>
  <header>
    <div class="banner">
      <button class="btn btn-link" onclick="window.location.href='/'">ãƒ›ãƒ¼ãƒ <br>ğŸ </button>
      <button class="btn btn-link" onclick="window.open('/edu/site', '_blank')">ã‚µã‚¤ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</button>
    </div>
  </header>
  <form id="IdForm">
    <input type="text" id="Idtext" placeholder="ä½œæˆã—ãŸã„ãƒšãƒ¼ã‚¸ã®Idã‚’å…¥åŠ›..." required>
    <button type="submit" name="action">ä½œæˆã™ã‚‹</button><br>
    <p id="errorMessage" style="color: red;"></p>
</form>
<section class="terms">
  <h2>ä½œã‚‹ã¨ãã®æ³¨æ„</h2>
  <ul>
    <strong>ã“ã“ã§æŒ‡å®šã—ãŸIdã¯ã‚µã‚¤ãƒˆã®URLã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã€Œappleã€ã‚’æŒ‡å®šã—ãŸå ´åˆã€https://(ã‚µã‚¤ãƒˆã®URL)/wk/appleã¨è¨€ã†å½¢å¼ã«ãªã‚Šã¾ã™</strong>
    <li>URLã«ä½¿ç”¨ã§ããªã„æ–‡å­—ã¯Idã«ä½¿ç”¨ã§ãã¾ã›ã‚“</li>
    <li>ä½œæˆä¸­ã«ãƒšãƒ¼ã‚¸ã‚’é›¢ã‚Œãªã„ã§ä¸‹ã•ã„ã€‚å…¥åŠ›ä¸­ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚</li>
    <li>ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡Œã†éš›ã¯ä»–ã®ã‚µã‚¤ãƒˆã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚</li>
    <li>ã€Œã‚ã€ã¨ã‹ã€æ„å‘³ä¸æ˜ãªãƒšãƒ¼ã‚¸ã¯æ¶ˆã—ã¦ã„ãã¾ã™(å®£è¨€)</li>
    <li>å€‹äººæƒ…å ±ã‚’å«ã‚ãªã„ã§ä¸‹ã•ã„ã€‚ã‚ãªãŸãŒä½œæˆã™ã‚‹ã‚µã‚¤ãƒˆã¯å…¬é–‹ã—ãŸæ®µéšã§ã™ãã«ã€Œèª°ã§ã‚‚ã¿ã‚Œã‚‹ã€çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚</li>
    <li>ä»–ã®ã‚µã‚¤ãƒˆã§åˆ©ç”¨ã—ã¦ã„ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯æ¥µåŠ›ä½¿ã‚ãªã„ã§ä¸‹ã•ã„ã€‚</li>
    <li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯èª°ã«ã‚‚æ•™ãˆãšå¤§åˆ‡ã«ä¿ç®¡ã—ã¦ä¸‹ã•ã„ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒã‚ã‚Œã°ã€ã‚ãªãŸã®ã‚µã‚¤ãƒˆã‚’ç·¨é›†ã§ãã¦ã—ã¾ã„ã¾ã™ã€‚</li>
  </ul>
</section>
<script>
document.getElementById('IdForm').addEventListener('submit', async function(event) { // asyncã‚’è¿½åŠ 
    event.preventDefault();
    const Id = document.getElementById('Idtext').value;
    const idPattern = /^[a-zA-Z0-9-_]+$/;
    const errorMessageElement = document.getElementById('errorMessage');
    errorMessageElement.textContent = '';
    if (!idPattern.test(Id)) {
        errorMessageElement.textContent = 'ã“ã®IDã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚';
        return;
    }
    try {
        const response = await fetch(`/edu/request?path=/req/${Id}`);
        if (!response.ok) {
            errorMessageElement.textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
            return;
        }
        const { p } = await response.json();
        if (p === "yes") {
            errorMessageElement.textContent = 'ã“ã®Idã¯ã™ã§ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™';
            return;
        }
        window.location.href = `/edu/create/${Id}`;
    } catch (err) {
        console.error('ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', err);
        errorMessageElement.textContent = 'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚';
    }
});

    </script>
</body>
</html>